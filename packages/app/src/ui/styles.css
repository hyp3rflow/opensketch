* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: Inter, system-ui, sans-serif; background: #1e1e1e; color: #ccc; overflow: hidden; height: 100vh; }
#app { display: flex; flex-direction: column; height: 100vh; gap: 4px; background: #1a1a1a; }
#toolbar { display: none; }
#workspace { flex: 1; display: flex; overflow: hidden; position: relative; }
#layers-panel { width: 260px; min-width: 260px; flex-shrink: 0; background: #252525; border-radius: 12px; overflow-y: auto; position: absolute; left: 12px; top: 12px; bottom: 12px; z-index: 10; box-shadow: 0 2px 8px rgba(0,0,0,0.2), 0 0 0 1px rgba(255,255,255,0.06); }
#canvas { flex: 1; display: block; cursor: default; min-width: 0; }
#properties-panel { width: 260px; min-width: 260px; flex-shrink: 0; background: #252525; border-radius: 12px; overflow-y: auto; overflow-x: hidden; padding: 14px; position: absolute; right: 12px; top: 12px; bottom: 12px; z-index: 10; box-shadow: 0 2px 8px rgba(0,0,0,0.2), 0 0 0 1px rgba(255,255,255,0.06); }
#bottom-toolbar { position: absolute; bottom: 16px; left: 50%; transform: translateX(-50%); z-index: 20; background: #2a2a2a; border-radius: 12px; display: flex; align-items: center; padding: 6px 8px; gap: 2px; box-shadow: 0 2px 8px rgba(0,0,0,0.2), 0 0 0 1px rgba(255,255,255,0.06); }
#statusbar { display: none; }

.tool-btn { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border: none; background: transparent; color: #aaa; border-radius: 4px; cursor: pointer; font-size: 16px; }
.tool-btn:hover { background: #3a3a3a; color: #fff; }
.tool-btn.active { background: #4a4af5; color: #fff; }
.tool-btn-separator { width: 1px; height: 20px; background: #3a3a3a; margin: 0 4px; }
.mode-toggle { display: flex; background: #1e1e1e; border-radius: 8px; padding: 2px; gap: 1px; }
.mode-btn { width: 30px; height: 28px; display: flex; align-items: center; justify-content: center; border: none; background: transparent; color: #666; border-radius: 6px; cursor: pointer; font-size: 14px; transition: all 0.15s; }
.mode-btn:hover { color: #aaa; background: rgba(255,255,255,0.04); }
.mode-btn.active { color: #fff; background: #4a4af5; box-shadow: 0 1px 4px rgba(74,74,245,0.3); }
.mode-btn svg { width: 14px; height: 14px; }

.layers-header { padding: 8px 12px; font-size: 11px; font-weight: 600; color: #888; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid #3a3a3a; }
.layer-item { padding: 4px 8px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 4px; border-left: 2px solid transparent; }
.layer-item:hover { background: #2a2a2a; }
.layer-item.selected { background: #2d3748; border-left-color: #4a4af5; }
.layer-arrow { display: inline-flex; align-items: center; justify-content: center; width: 14px; height: 14px; flex-shrink: 0; }
.layer-item .layer-icon { opacity: 0.5; display: flex; align-items: center; }
.layer-item .layer-name { flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.layer-item .layer-visibility { opacity: 0.3; cursor: pointer; display: flex; align-items: center; }
.layer-item .layer-visibility:hover { opacity: 1; }

.prop-section { margin-bottom: 16px; }
.prop-section-title { font-size: 11px; font-weight: 600; color: #888; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px; }
.prop-row { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
.prop-label { font-size: 11px; color: #888; width: 24px; text-align: right; }
.prop-input { flex: 1; min-width: 0; background: #333; border: 1px solid #444; border-radius: 4px; padding: 4px 8px; color: #ccc; font-size: 12px; font-family: inherit; box-sizing: border-box; }
.prop-input:focus { outline: none; border-color: #4a4af5; }
select.prop-input { appearance: none; background: #333 url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%23888'/%3E%3C/svg%3E") no-repeat right 8px center; padding-right: 24px; }
.prop-color-swatch { width: 24px; height: 24px; border-radius: 4px; border: 1px solid #555; cursor: pointer; }
.prop-slider { flex: 1; accent-color: #4a4af5; height: 4px; cursor: pointer; }
.prop-add-btn { width: 100%; padding: 6px; background: transparent; border: 1px dashed #444; border-radius: 4px; color: #666; font-size: 11px; cursor: pointer; font-family: inherit; }
.prop-add-btn:hover { border-color: #666; color: #999; background: #2a2a2a; }

/* Design System Panel */
.ds-header { padding: 8px 12px; border-bottom: 1px solid #333; }
.ds-title { font-size: 11px; font-weight: 600; color: #888; text-transform: uppercase; letter-spacing: 0.5px; }
.ds-name-row { padding: 8px 12px; }
.ds-tabs { display: inline-flex; background: #1e1e1e; border-radius: 10px; padding: 3px; gap: 2px; margin: 0 12px 8px; }
.ds-tab { padding: 6px 16px; font-size: 12px; background: transparent; border: none; color: #666; cursor: pointer; font-family: inherit; border-radius: 8px; transition: all 0.15s; font-weight: 500; }
.ds-tab:hover { color: #aaa; background: rgba(255,255,255,0.04); }
.ds-tab.active { color: #fff; background: #4a4af5; box-shadow: 0 1px 4px rgba(74,74,245,0.3); }
.ds-content { padding: 12px; }
.ds-color-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 4px; }
.ds-color-swatch { width: 100%; aspect-ratio: 1; border-radius: 6px; cursor: pointer; transition: transform 0.1s, box-shadow 0.1s; }
.ds-color-swatch:hover { transform: scale(1.15); box-shadow: 0 2px 8px rgba(0,0,0,0.4); z-index: 1; }
.ds-hint { font-size: 10px; color: #555; text-align: center; margin-top: 8px; }
.ds-type-item { padding: 8px; border-radius: 6px; cursor: pointer; margin-bottom: 4px; display: flex; flex-direction: column; gap: 2px; }
.ds-type-item:hover { background: #2a2a2a; }
.ds-type-preview { color: #ccc; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.ds-type-meta { font-size: 10px; color: #555; }
.ds-spacing-item { display: flex; align-items: center; gap: 8px; padding: 4px 0; }
.ds-spacing-label { font-size: 11px; color: #888; width: 32px; text-align: right; }
.ds-spacing-bar { height: 8px; background: #4a4af5; border-radius: 4px; min-width: 4px; opacity: 0.6; }
.ds-spacing-value { font-size: 10px; color: #555; }

/* Note Overlay */
#note-overlay { position: absolute; inset: 0; pointer-events: none; z-index: 5; overflow: hidden; }
.note-card { position: absolute; pointer-events: auto; background: #2a2a2a; border-radius: 10px; box-shadow: 0 2px 12px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.06); max-width: 280px; min-width: 160px; transition: box-shadow 0.15s; }
.note-card:hover { box-shadow: 0 4px 20px rgba(0,0,0,0.4), 0 0 0 1px rgba(251,191,36,0.2); }
.note-card-header { display: flex; align-items: center; gap: 6px; padding: 8px 12px; }
.note-card-badge { font-size: 11px; color: #fbbf24; display: flex; align-items: center; gap: 4px; }
.note-card-title { font-size: 11px; font-weight: 600; color: #aaa; flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.note-card.expanded .note-card-header { border-bottom: 1px solid #333; }
.note-card-content { padding: 8px 12px; border-bottom: 1px solid rgba(255,255,255,0.04); }
.note-card-content:last-child { border-bottom: none; }
.note-card-tags { display: flex; gap: 4px; margin-bottom: 6px; flex-wrap: wrap; }
.note-card-tag { font-size: 9px; background: rgba(251,191,36,0.15); color: #fbbf24; padding: 1px 6px; border-radius: 4px; }
.note-card-text { font-size: 11px; color: #bbb; line-height: 1.6; }
.note-md-h1 { font-size: 13px; font-weight: 700; color: #e5e5e5; margin: 4px 0 2px; }
.note-md-h2 { font-size: 12px; font-weight: 600; color: #ddd; margin: 3px 0 2px; }
.note-md-h3 { font-size: 11px; font-weight: 600; color: #ccc; margin: 2px 0 1px; }
.note-md-li { padding-left: 8px; }
.note-md-br { height: 4px; }
.note-md-code { background: #1e1e1e; padding: 1px 4px; border-radius: 3px; font-family: monospace; font-size: 10px; color: #e5a0ff; }

/* Design System Modal */
.ds-modal-backdrop { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 100; align-items: center; justify-content: center; }
.ds-modal-backdrop.open { display: flex; }
.ds-modal { background: #252525; border-radius: 16px; width: 520px; max-height: 80vh; box-shadow: 0 8px 32px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.06); display: flex; flex-direction: column; overflow: hidden; }
.ds-modal-header { display: flex; align-items: center; justify-content: space-between; padding: 16px 20px; border-bottom: 1px solid #333; flex-shrink: 0; }
.ds-modal-title { font-size: 15px; font-weight: 600; color: #ccc; }
.ds-modal-close { background: transparent; border: none; color: #666; font-size: 18px; cursor: pointer; width: 28px; height: 28px; border-radius: 6px; display: flex; align-items: center; justify-content: center; }
.ds-modal-close:hover { background: #333; color: #ccc; }
.ds-modal-body { overflow-y: auto; flex: 1; }

/* Agent Panel */
#agent-panel { position: absolute; right: 12px; bottom: 60px; width: 300px; height: 360px; background: #252525; border-radius: 12px; z-index: 20; box-shadow: 0 2px 8px rgba(0,0,0,0.2), 0 0 0 1px rgba(255,255,255,0.06); display: none; flex-direction: column; overflow: hidden; }
#agent-panel.open { display: flex; }
#agent-toggle { position: absolute; right: 12px; bottom: 16px; z-index: 20; width: 40px; height: 40px; border-radius: 10px; background: #2a2a2a; border: none; color: #aaa; font-size: 18px; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(0,0,0,0.2), 0 0 0 1px rgba(255,255,255,0.06); transition: background 0.15s; }
#agent-toggle:hover { background: #333; color: #fff; }
#agent-toggle.active { background: #4a4af5; color: #fff; }
.agent-header { display: flex; align-items: center; justify-content: space-between; padding: 10px 14px; border-bottom: 1px solid #333; flex-shrink: 0; }
.agent-title { font-size: 13px; font-weight: 600; color: #ccc; display: flex; align-items: center; gap: 6px; }
.agent-icon { display: flex; align-items: center; opacity: 0.7; }
.agent-mode-toggle { display: flex; gap: 2px; background: #1a1a1a; border-radius: 6px; padding: 2px; }
.agent-mode-btn {
  padding: 3px 10px; border: none; border-radius: 4px; font-size: 10px; font-weight: 600;
  letter-spacing: 0.5px; cursor: pointer; transition: all 0.15s;
  background: transparent; color: #666;
}
.agent-mode-btn.active { background: #4f46e5; color: #fff; }
.agent-mode-btn:hover:not(.active) { color: #999; }
.agent-status { font-size: 10px; padding: 2px 8px; border-radius: 10px; }
.agent-status.online { background: rgba(16,185,129,0.15); color: #10B981; }
.agent-messages { flex: 1; overflow-y: auto; padding: 10px 14px; display: flex; flex-direction: column; gap: 6px; }
.agent-msg { font-size: 12px; line-height: 1.5; padding: 6px 10px; border-radius: 8px; max-width: 90%; white-space: pre-wrap; word-break: break-word; }
.agent-msg-user { background: #4a4af5; color: #fff; align-self: flex-end; border-bottom-right-radius: 2px; }
.agent-msg-agent { background: #333; color: #ccc; align-self: flex-start; border-bottom-left-radius: 2px; }
.agent-msg-system { background: transparent; color: #666; align-self: center; font-size: 11px; font-style: italic; }
.agent-input-area { display: flex; gap: 6px; padding: 10px 14px; border-top: 1px solid #333; flex-shrink: 0; }
.agent-input { flex: 1; background: #333; border: 1px solid #444; border-radius: 8px; padding: 8px 12px; color: #ccc; font-size: 12px; font-family: inherit; outline: none; }
.agent-input:focus { border-color: #4a4af5; }
.agent-send { width: 36px; background: #4a4af5; border: none; border-radius: 8px; color: #fff; font-size: 16px; cursor: pointer; transition: background 0.15s; }
.agent-send:hover { background: #5b5bf5; }
